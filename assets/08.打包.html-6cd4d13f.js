import{_ as s,V as t,W as e,Y as n,Z as p,$ as l,X as o,F as c}from"./framework-a569e214.js";const i="/img/springboot/image-20210510204738225.png",u="/img/springboot/image-20210511101209082.png",g="/img/springboot/image-20210511104038760.png",d={},r=o('<h2 id="jar包" tabindex="-1"><a class="header-anchor" href="#jar包" aria-hidden="true">#</a> jar包</h2><p>SpringBoot默认的打包方式。</p><p>在IDEA中，点击package即可在项目编译之后的target目录下生成jar文件。</p><figure><img src="'+i+`" alt="image-20210510204738225" tabindex="0" loading="lazy"><figcaption>image-20210510204738225</figcaption></figure><blockquote><p><code>jar -jar jar包名称 参数</code>即可运行jar包。</p></blockquote><h2 id="war包" tabindex="-1"><a class="header-anchor" href="#war包" aria-hidden="true">#</a> war包</h2><p><code>porm文件修改</code></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">&gt;</span></span>war<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-war-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>failOnMissingWebXml</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>failOnMissingWebXml</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">scope取值</th><th style="text-align:left;">有效范围（compile, runtime, test）</th><th style="text-align:left;">依赖传递</th><th style="text-align:left;">例子</th></tr></thead><tbody><tr><td style="text-align:left;">compile</td><td style="text-align:left;">all</td><td style="text-align:left;">是</td><td style="text-align:left;">spring-core</td></tr><tr><td style="text-align:left;">provided</td><td style="text-align:left;">compile, test</td><td style="text-align:left;">否</td><td style="text-align:left;">servlet-api</td></tr><tr><td style="text-align:left;">runtime</td><td style="text-align:left;">runtime, test</td><td style="text-align:left;">是</td><td style="text-align:left;">JDBC驱动</td></tr><tr><td style="text-align:left;">test</td><td style="text-align:left;">test</td><td style="text-align:left;">否</td><td style="text-align:left;">JUnit</td></tr><tr><td style="text-align:left;">system</td><td style="text-align:left;">compile, test</td><td style="text-align:left;">是</td><td style="text-align:left;"></td></tr></tbody></table><p><code>main方法</code></p><p>如果以war包的方式打包，SpringBoot的main方法就没用了。这时候<code>程序的入口就是Tomcat</code>。这时候我们必须要写一个类注入到容器中，这个类要把<code>SpringBoot的主启动类传入</code>。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletInitializer</span> <span class="token keyword">extends</span> <span class="token class-name">SpringBootServletInitializer</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * Springboot01Application 主启动类 Springboot
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token class-name">SpringApplicationBuilder</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SpringApplicationBuilder</span> builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">sources</span><span class="token punctuation">(</span><span class="token class-name">Springboot01Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>这时候就是由Tomcat加载ApplicationContext。SpringBootServletInitializer就相当于之前的web.xml文件。</p></blockquote><p>在IDEA中直接打包</p><figure><img src="`+u+'" alt="image-20210511101209082" tabindex="0" loading="lazy"><figcaption>image-20210511101209082</figcaption></figure><blockquote><p>Tomcat启动干了什么</p></blockquote>',16),k={href:"https://www.bilibili.com/video/BV1JU4y1p75q?p=19",target:"_blank",rel:"noopener noreferrer"},v=n("ul",null,[n("li",null,"ServletContainerInitializer接口的实现类"),n("li",null,"file META-INF/services/javax.servlet.ServletContainerInitializer （spi机制）。调用onStartup方法。")],-1),m=n("figure",null,[n("img",{src:g,alt:"image-20210511104038760",tabindex:"0",loading:"lazy"}),n("figcaption",null,"image-20210511104038760")],-1),b=n("ul",null,[n("li",null,"servletContext 配置过滤器、servlet、filter、listener")],-1);function f(x,y){const a=c("ExternalLinkIcon");return t(),e("div",null,[r,n("p",null,[n("a",k,[p("https://www.bilibili.com/video/BV1JU4y1p75q?p=19"),l(a)])]),v,m,b])}const _=s(d,[["render",f],["__file","08.打包.html.vue"]]);export{_ as default};
